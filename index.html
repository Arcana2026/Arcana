<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arcana Safe ‚Äî √âcosyst√®me Multi-Wallet & Casino</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Cinzel:wght@700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/@web3-onboard/core"></script>
    <script src="https://cdn.jsdelivr.net/npm/@web3-onboard/injected-wallets"></script>
    <script src="https://cdn.jsdelivr.net/npm/@web3-onboard/walletconnect"></script>

    <style>
        body { background-color: #0b0e11; color: #F7E7CE; font-family: 'Inter', sans-serif; height: 100vh; overflow: hidden; margin: 0; }
        .app-layout { display: flex; height: 100vh; }
        .app-sidebar { width: 85px; background: #0a0a0a; border-right: 1px solid rgba(212, 175, 55, 0.35); display: flex; flex-direction: column; align-items: center; padding: 2rem 0; gap: 2.5rem; }
        .app-sidebar-logo { width: 55px; height: 55px; border-radius: 50%; filter: drop-shadow(0 0 10px #D4AF37); }
        .app-main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        .app-topbar { height: 70px; background: #0a0a0a; border-bottom: 1px solid rgba(255, 255, 255, 0.05); display: flex; align-items: center; justify-content: space-between; padding: 0 2.5rem; }
        .app-content { flex: 1; overflow-y: auto; padding: 40px; scroll-behavior: smooth; }
        .glass-card { background: #15181c; border: 1px solid rgba(212, 175, 55, 0.1); border-radius: 20px; padding: 2rem; margin-bottom: 2rem; }
        .btn-gold { background: linear-gradient(135deg, #D4AF37, #B8860B); color: #000; font-weight: 700; padding: 12px 24px; border-radius: 12px; transition: 0.3s; }
        .font-luxury { font-family: 'Cinzel', serif; }
        .text-gold { color: #D4AF37; }
    </style>
</head>
<body>

    <div class="app-layout">
        <aside class="app-sidebar">
            <img src="logo.png" alt="Arcana" class="app-sidebar-logo">
            <div class="cursor-pointer opacity-50 hover:opacity-100" title="Dashboard">üè†</div>
            <div class="cursor-pointer opacity-50 hover:opacity-100" title="Casino">üé∞</div>
            <div class="cursor-pointer opacity-50 hover:opacity-100" title="Profil">üë§</div>
        </aside>

        <div class="app-main">
            <header class="app-topbar">
                <div class="font-luxury text-xl tracking-widest text-white">ARCANA <span class="text-gold">SAFE</span></div>
                <div class="flex items-center gap-8">
                    <div class="text-[10px] uppercase text-gray-500">Solde : <span id="topBalance" class="text-white text-sm font-bold">0</span> <span class="text-gold font-bold">ARCANA</span></div>
                    <button id="connectBtn" class="btn-gold text-xs">CONNECTER WALLET</button>
                </div>
            </header>

            <div class="app-content">
                <div class="mb-12">
                    <h1 class="font-luxury text-5xl mb-4">LE SANCTUAIRE <span class="text-gold">D√âCENTRALIS√â</span></h1>
                    <p class="text-gray-500 italic max-w-xl border-l border-gold/30 pl-4">S√©curisez votre avenir avec Arcana Safe, o√π chaque jeu r√©compense la communaut√©.</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
                    <div class="glass-card">
                        <h2 class="font-luxury text-2xl text-gold mb-4">CASINO REDISTRIBUTION (10%)</h2>
                        <p class="text-sm text-gray-400 mb-6">Mise directe via Smart Contract. 10% des jetons Arcana sont redistribu√©s on-chain.</p>
                        <div class="bg-black/40 p-6 rounded-2xl border border-white/5">
                            <p class="text-[10px] text-gray-500 uppercase mb-4 tracking-widest">Votre Mise ARCANA</p>
                            <input type="number" id="betInput" value="10" class="w-full bg-transparent text-4xl font-bold text-white outline-none mb-6">
                            <button id="spinBtn" class="btn-gold w-full py-4 mb-2">LANCER LE SPIN üé∞</button>
                            <button id="approveBtn" class="text-[10px] text-gray-600 underline block w-full text-center hover:text-white transition">APPROUVER LE CONTRAT</button>
                        </div>
                    </div>

                    <div class="glass-card">
                        <h2 class="font-luxury text-2xl text-gold mb-4">üéÅ BONUS DE BIENVENUE</h2>
                        <div class="space-y-4 text-sm text-gray-300">
                            <p>‚Ä¢ <strong>100%</strong> sur votre premier d√©p√¥t vers le Coffre.</p>
                            <p>‚Ä¢ <strong>5 spins gratuits</strong> sur la Roue Arcane.</p>
                            <div class="p-4 bg-gold/10 rounded-xl border border-gold/20 mt-4">
                                <p class="text-xs text-gold">100% des profits servent au Buyback d'ARCANA.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="whitepaper" class="glass-card">
                    <h2 class="font-luxury text-2xl text-center mb-8 tracking-[4px]">üìñ LIVRE BLANC</h2>
                    <div class="space-y-8 text-sm text-gray-400 leading-relaxed">
                        <section>
                            <h3 class="font-bold text-white uppercase border-b border-gold/20 mb-2">1. Vision</h3>
                            <p>Arcana Safe est le sanctuaire de vos actifs. Nous b√¢tissons une forteresse num√©rique prot√©g√©e par des protocoles inviolables, assurant que votre valeur reste entre vos mains.</p>
                        </section>
                        <section>
                            <h3 class="font-bold text-white uppercase border-b border-gold/20 mb-2">2. Tokenomics</h3>
                            <p>Offre totale : 400 000 000 ARCANA. Une redistribution de 10% des gains du casino est inject√©e dans la liquidit√© pour stabiliser l'√©cosyst√®me.</p>
                        </section>
                        <section>
                            <h3 class="font-bold text-white uppercase border-b border-gold/20 mb-2">3. S√©curit√©</h3>
                            <p>Le syst√®me de Claim diff√©r√© garantit la stabilit√©. Les jetons ne sont lib√©r√©s qu'apr√®s avoir atteint l'objectif de 100 000 $ de la pr√©vente.</p>
                        </section>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed bottom-6 right-6 z-50">
        <div onclick="document.getElementById('vaultWindow').classList.toggle('hidden')" class="w-14 h-14 bg-gold rounded-full flex items-center justify-center text-black font-bold cursor-pointer shadow-2xl hover:scale-110 transition">ARC</div>
        <div id="vaultWindow" class="hidden absolute bottom-20 right-0 w-64 glass-card shadow-2xl border-gold/30">
            <p class="text-xs text-gold font-bold mb-2">GUIDE POCHE</p>
            <p class="text-[10px] text-gray-500 mb-4">R√âSERVE ACTUELLE</p>
            <h4 id="vaultBalance" class="text-2xl font-bold">0 ARCANA</h4>
            <hr class="my-4 border-white/5">
            <p class="text-[10px] text-green-500 font-bold">‚óè POLYGON MAINNET LIVE</p>
        </div>
    </div>

    <script>
        const PROJECT_ID = "8893d93707736e4f3586071930777991";
        const CONTRACT_ADDR = "0x0a6Db8dfc670dDc655Ed5eEDa4746a687CfE2744";
        const TOKEN_ADDR = "0x29D61511C84E332635E296e37bf22Eb4fB514147";

        // Multi-Wallet Config
        const injected = window.web3OnboardInjectedWallets.default();
        const walletConnect = window.web3OnboardWalletConnect.default({ projectId: PROJECT_ID, version: 2 });
        const onboard = window.web3OnboardCore.default({
            wallets: [injected, walletConnect],
            chains: [{ id: '0x89', token: 'POL', label: 'Polygon', rpcUrl: 'https://polygon-rpc.com' }],
            appMetadata: { name: 'Arcana Safe', description: 'Luxury Casino Vault' }
        });

        let walletSigner;

        async function connect() {
            const wallets = await onboard.connectWallet();
            if (wallets[0]) {
                const provider = new ethers.providers.Web3Provider(wallets[0].provider);
                walletSigner = provider.getSigner();
                const addr = wallets[0].accounts[0].address;
                document.getElementById('connectBtn').innerText = addr.slice(0,6)+"..."+addr.slice(-4);
                
                // Update Balances
                const tokenAbi = ["function balanceOf(address owner) view returns (uint256)"];
                const tokenContract = new ethers.Contract(TOKEN_ADDR, tokenAbi, provider);
                const balance = await tokenContract.balanceOf(addr);
                const formatted = ethers.utils.formatUnits(balance, 18).split('.')[0];
                document.getElementById('topBalance').innerText = formatted;
                document.getElementById('vaultBalance').innerText = formatted + " ARCANA";
            }
        }

        async function approveToken() {
            if(!walletSigner) return Swal.fire("Connectez-vous");
            const abi = ["function approve(address spender, uint256 amount) returns (bool)"];
            const contract = new ethers.Contract(TOKEN_ADDR, abi, walletSigner);
            const tx = await contract.approve(CONTRACT_ADDR, ethers.constants.MaxUint256);
            Swal.fire("Approbation", "Traitement en cours...", "info");
            await tx.wait();
            Swal.fire("Succ√®s", "Le Casino est maintenant autoris√©.", "success");
        }

        async function playSlots() {
            if(!walletSigner) return Swal.fire("Connectez-vous");
            const amount = document.getElementById('betInput').value;
            const abi = ["function playSlots(uint256 betAmount) external"];
            const contract = new ethers.Contract(CONTRACT_ADDR, abi, walletSigner);
            try {
                const tx = await contract.playSlots(ethers.utils.parseUnits(amount, 18));
                await tx.wait();
                Swal.fire("Gagn√© !", "La redistribution de 10% a √©t√© valid√©e.", "success");
                connect(); // Refresh balance
            } catch (e) {
                Swal.fire("Erreur", "V√©rifiez votre solde ARCANA ou l'approbation.", "error");
            }
        }

        document.getElementById('connectBtn').onclick = connect;
        document.getElementById('approveBtn').onclick = approveToken;
        document.getElementById('spinBtn').onclick = playSlots;
    </script>
</body>
</html>